<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Checkout</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header class="main-header">
        <div class="container header-content"><a href="index.html" class="logo">GRUPO <span>PREMIA</span></a></div>
    </header>
    <div class="page-container">
        <h2>Detalles de Envío</h2>
        <form id="checkoutForm" style="margin-top:30px;">
            <input type="text" class="form-control" placeholder="Nombre completo" required style="margin-bottom:15px;">
            <input type="text" class="form-control" placeholder="Dirección de entrega" required
                style="margin-bottom:30px;">
            <div
                style="border-top:1px solid #eee; padding-top:20px; display:flex; justify-content:space-between; align-items:center;">
                <h3>Total: <span id="payTotal" class="text-red">Q0.00</span></h3>
                <button type="submit" class="btn-primary" style="width:auto;">PAGAR AHORA</button>
            </div>
        </form>
    </div>
    <script type="module">
        import { getCart, clearCart, saveOrder, getCurrentUser } from './utils.js';
        const cart = getCart(); if (cart.length === 0) window.location.href = 'carrito.html';
        const total = cart.reduce((s, i) => s + i.price, 0); document.getElementById('payTotal').innerText = `Q${total.toFixed(2)}`;
        const user = getCurrentUser();
        document.getElementById('checkoutForm').addEventListener('submit', (e) => {
            e.preventDefault(); e.target.querySelector('button').innerText = "PROCESANDO...";
            setTimeout(() => {
                saveOrder({ id: Date.now(), date: new Date().toLocaleDateString(), total: total, items: cart, status: "PAGADO" });
                clearCart();
                alert(user ? "¡Pedido guardado en tu perfil!" : "¡Pedido realizado con éxito!");
                window.location.href = user ? 'perfil.html' : 'index.html';
            }, 2000);
        });
    </script>
</body>

</html>